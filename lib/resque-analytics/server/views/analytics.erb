<h1>Resque Analytics</h1>

<p class="intro">
  Various KPIs related to Resque jobs
</p>

<% @data.keys.each do |job| %>
  <h2><%= job %></h2>
  <% performed = chart_data(@data, job, Resque::Plugins::Analytics::PERFORMED) %>
  <% failed = chart_data(@data, job, Resque::Plugins::Analytics::FAILED) %>
  <%= Gchart.bar(
    data: [performed, failed],
    title: "Number of jobs",
    format: "image_tag",
    size: "1000x300",
    axis_with_labels: ['x,y'],
    bar_width_and_spacing: '6',
    axis_range: [[-90,0,-5], [0, performed.max + failed.max ]],
    legend: [Resque::Plugins::Analytics::PERFORMED, Resque::Plugins::Analytics::FAILED],
    bar_colors: ['000000', '0088FF']
  ) %>

  <% run_time = chart_data(@data, job, Resque::Plugins::Analytics::TOTAL_TIME) %>
  <%= Gchart.bar(
    data: [run_time],
    title: "Run time",
    format: "image_tag",
    size: "1000x300",
    axis_with_labels: ['x,y'],
    bar_width_and_spacing: '6',
    axis_range: [[-90,0,-5], [0, run_time.max ]],
    legend: [Resque::Plugins::Analytics::TOTAL_TIME]
  ) %>

<% end %>